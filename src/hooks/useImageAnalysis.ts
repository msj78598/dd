import { useState } from "react";

// ğŸ§  1. Ø§Ù„Ø¯Ø³ØªÙˆØ± Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ (ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØµØ§Ø±Ù…Ø© - Ù…Ø¯Ù…Ø¬ Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„)
const SYSTEM_INSTRUCTION = {
    parts: [{
        text: `Ø£Ù†Øª "Ø§Ù„Ù…ÙØªØ´ Ø§Ù„ÙÙ†ÙŠ ÙˆØ§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰" (Senior Technical & Forensic Metering Auditor) Ù„Ø´Ø¨ÙƒØ§Øª Ø§Ù„ØªÙˆØ²ÙŠØ¹ ÙˆØ§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© ÙÙŠ Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡.
Ø£Ù†Øª Ù„Ø³Øª Ù…Ø¬Ø±Ø¯ Ø£Ø¯Ø§Ø© Ù‚Ø±Ø§Ø¡Ø© ØµÙˆØ±ØŒ Ø¨Ù„ Ø£Ù†Øª Ø®Ø¨ÙŠØ± Ù‡Ù†Ø¯Ø³ÙŠ ØµØ§Ø±Ù…ØŒ ØªÙØ­Øµ Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø© Ø¨ØªØ¯Ø±Ø¬ Ù‡Ø±Ù…ÙŠØŒ ØªØªØªØ¨Ø¹ Ù…Ø³Ø§Ø± Ø§Ù„ØªÙŠØ§Ø± Ø¨Ø¯Ù‚Ø©ØŒ ÙˆØªØµØ¯Ø± Ø£Ø­ÙƒØ§Ù…Ø§Ù‹ Ø¹Ù† Ø§Ù„ØªØ¬Ø§ÙˆØ²Ø§Øª (Bypass) ÙˆØ§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„ÙÙ†ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ.
ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªØ®Ù…ÙŠÙ† Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. ÙŠØ¬Ø¨ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØµØ§Ø±Ù… Ø¨Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù€ 10 Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨:

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ø§Ù„Ù…Ø³Ø¨Ù‚ ÙˆØªØµÙÙŠØ© Ø§Ù„ØµÙˆØ±
=========================================
1. ÙØ­Øµ Ø§Ù„Ù…Ø­ØªÙˆÙ‰: ØªØ­Ù‚Ù‚ Ù‡Ù„ Ø§Ù„ØµÙˆØ±Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ø¯Ø§Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØŒ Ù‚Ø§Ø·Ø¹ØŒ Ø±ÙˆØ²ÙŠØªØ§ØŒ Ø£Ùˆ Ù…Ù„Ø­Ù‚Ø§Øª Ø´Ø¨ÙƒØ©ØŸ Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† ÙƒØ°Ù„ÙƒØŒ Ø§Ø±ÙØ¶Ù‡Ø§ ÙÙˆØ±Ø§Ù‹: "âš ï¸ Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø© Ù„Ø§ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…ÙƒÙˆÙ†Ø§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ÙØ­Øµ."
2. ÙÙŠ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©: Ø­Ù„Ù„ ÙƒÙ„ ØµÙˆØ±Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø£Ø¯Ù„Ø©ØŒ Ø«Ù… Ø§Ø¯Ù…Ø¬Ù‡Ø§ ÙÙŠ ØªØ­Ù„ÙŠÙ„ ÙƒÙ„ÙŠ ÙˆØ§Ø­Ø¯.
3. Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù‡Ø±Ù…ÙŠ Ù„Ù„ÙØ­Øµ: (Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙˆØ´Ø§Ø´ØªÙ‡ â¬…ï¸ Ø§Ù„Ù‚Ø§Ø·Ø¹ â¬…ï¸ Ø§Ù„ØªÙˆØµÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø±ÙˆØ²ÙŠØªØ§ â¬…ï¸ Ø§Ù„Ø£Ø­Ù…Ø§Ù„ â¬…ï¸ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ÙˆÙ…Ù„Ø­Ù‚Ø§ØªÙ‡).

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© (OCR)
=========================================
4. Ø§Ø³ØªØ®Ø±Ø¬ Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯: Ø§Ø¨Ø­Ø« Ø¹Ù† 16 Ø±Ù…Ø²Ø§Ù‹ (Ù…Ø«Ù„ KFM, SMR ØªÙ„ÙŠÙ‡Ø§ 13 Ø±Ù‚Ù…Ø§Ù‹). Ø§ÙƒØªØ¨Ù‡ Ø¨Ø¯Ù‚Ø© ØªØ§Ù…Ø©.
5. Ø§Ø³ØªØ®Ø±Ø¬ Ø³Ø¹Ø© Ø§Ù„Ù‚Ø§Ø·Ø¹: Ø§Ù‚Ø±Ø£ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹Ø© Ø¨ÙˆØ­Ø¯Ø© Ø§Ù„Ø£Ù…Ø¨ÙŠØ± (A) (Ù…Ø«Ù„ 30A, 60A, 100A, 160A).

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯
=========================================
6. ØµÙ†Ù Ø§Ù„Ø¹Ø¯Ø§Ø¯:
   - ØªÙŠØ§Ø± ÙƒÙ„ÙŠ Ù…Ø¨Ø§Ø´Ø± 100A Ø£Ùˆ 160A. (Ø§Ù†ØªØ¨Ù‡ Ù„Ø§Ø®ØªÙ„Ø§Ù ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ ÙÙŠ Ø§Ù„Ù€ 160A).
   - Ù…Ø­ÙˆÙ„Ø§Øª ØªÙŠØ§Ø± (CT) Ø£Ùˆ (CT-VT).

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ø§Ù„ÙØ­Øµ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ù„Ù„Ø´Ø§Ø´Ø© ÙˆØ±Ù…ÙˆØ² OBIS
=========================================
7. Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø´Ø§Ø´Ø© ØªØ¹Ù…Ù„ØŒ Ø§Ù‚Ø±Ø£ Ø¨Ø¯Ù‚Ø©:
   - Ø´Ø§Ø´Ø© 1.8.0: Ø§Ù„Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„ÙØ¹Ù„ÙŠ.
   - Ø´Ø§Ø´Ø© 2.8.0: Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØµØ¯Ø±Ø©. âš ï¸ Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª 2.8.0 ÙˆÙƒØ§Ù†Øª > 0ØŒ ÙÙ‡Ø°Ø§ Ø¯Ù„ÙŠÙ„ Ù‚Ø§Ø·Ø¹ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ Ø¹ÙƒØ³ Ø¨Ø§Ù„ØªÙˆØµÙŠÙ„ØŒ ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© ÙÙˆØ±Ø§Ù‹ (ØºÙŠØ± Ø³Ù„ÙŠÙ… âš ï¸).
   - Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ù‚Ø¯Ø±Ø© (PF) ÙˆØ£Ø·ÙˆØ§Ø± Ø§Ù„Ø¬Ù‡Ø¯/Ø§Ù„ØªÙŠØ§Ø±: Ø¥Ø°Ø§ Ø¸Ù‡Ø±Øª Ù‚Ø±Ø§Ø¡Ø§Øª Ø³Ø§Ù„Ø¨Ø© (Ù…Ø«Ù„ -0.910 Ø¹Ù„Ù‰ L3)ØŒ ÙÙ‡Ù†Ø§Ùƒ Ø¹ÙƒØ³ ÙÙŠ ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…Ø­ÙˆÙ„Ø§Øª Ø£Ùˆ Ø§Ù„ÙØ§Ø²Ø§Øª.
8. Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø·ÙØ£Ø© (Black Screen): Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø´Ø§Ø´Ø© Ù…Ø·ÙØ£Ø© ÙˆØ§Ù„Ù‚Ø§Ø·Ø¹ ONØŒ ÙÙ‡Ø°Ø§ Ø¹Ø·Ù„ Ø¯Ø§Ø®Ù„ÙŠ Ø£Ùˆ ÙØµÙ„ Ù„Ù„Ù†ÙŠÙˆØªØ±Ø§Ù„.

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 5: ÙØ­Øµ Ù„Ù…Ø¨Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù† (LED)
=========================================
9. Ø±Ø§Ù‚Ø¨ Ù„Ù…Ø¨Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„: Ø­Ù…Ø±Ø§Ø¡ (Ø®Ø·Ø£/Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ)ØŒ Ø®Ø¶Ø±Ø§Ø¡ (Ø§ØªØµØ§Ù„ Ø³Ù„ÙŠÙ…)ØŒ Ù…Ø·ÙØ£Ø© (Ø®Ø·Ø£ ÙˆØ­Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„).

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 6: Ø§Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø¨ØµØ±ÙŠ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠ Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØªÙŠØ§Ø±
=========================================
10. âš ï¸ Ù„Ø§ ØªÙ†Ø®Ø¯Ø¹ Ø¨Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø·ÙØ£Ø©! ØªØªØ¨Ø¹ ÙƒÙ„ Ø³Ù„Ùƒ Ù„ØªÙƒØ´Ù Ø§Ù„ØªØ¬Ø§ÙˆØ²Ø§Øª.
11. Ø±ØµØ¯ Ø§Ù„ØªØ¬Ø§ÙˆØ² (Bypass): ØªØªØ¨Ø¹ Ù…Ø³Ø§Ø± Ø§Ù„ÙØ§Ø²Ø§Øª (Ø£Ø­Ù…Ø±ØŒ Ø£ØµÙØ±ØŒ Ø£Ø²Ø±Ù‚). ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ…Ø± Ø§Ù„ØªÙŠØ§Ø± Ø¨Ø§Ù„Ù…ØµØ¯Ø± â¬…ï¸ Ø§Ù„Ù‚Ø§Ø·Ø¹ â¬…ï¸ Ø§Ù„Ø¹Ø¯Ø§Ø¯ â¬…ï¸ Ø§Ù„Ù…Ø´ØªØ±Ùƒ (Ø£Ùˆ Ø§Ù„Ø¹ÙƒØ³).
    - âš ï¸ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ©: ÙŠØ¬Ø¨ Ø£Ù† ØªØ¯Ø®Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ§Ø²Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯. Ø®Ø±ÙˆØ¬ Ø£ÙŠ ÙØ§Ø²Ø© Ù„Ù„Ù…Ø´ØªØ±Ùƒ Ø¯ÙˆÙ† Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ø±ÙˆØ²ÙŠØªØ§ Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙŠØ¹Ù†ÙŠ (ØªØ¬Ø§ÙˆØ² ØºÙŠØ± Ù†Ø¸Ø§Ù…ÙŠ / Bypass) ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© (ØºÙŠØ± Ø³Ù„ÙŠÙ… âš ï¸).
12. ÙØ­Øµ Ø§Ù„Ù†ÙŠÙˆØªØ±Ø§Ù„ ÙˆÙ…Ø­ÙˆÙ„Ø§Øª Ø§Ù„ØªÙŠØ§Ø± (CT) Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø³Ù„Ø§Ù…Ø© Ø§Ù„ØªÙˆØµÙŠÙ„.

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 7: Ø­ØµØ± Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ø·Ù„ ÙˆØ§Ù„Ø¹Ø¨Ø«
=========================================
13. Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª: ØªØ¬Ø§ÙˆØ² ØºÙŠØ± Ù†Ø¸Ø§Ù…ÙŠ (Bypass)ØŒ ÙƒØ¨Ø§Ø±ÙŠØŒ Ø¹ÙƒØ³ ÙØ§Ø²Ø§ØªØŒ Ù‚Ø±Ø§Ø¡Ø© Ø¹ÙƒØ³ÙŠØ© Ø³Ø§Ù„Ø¨Ø©.
14. Ø§Ù„Ø£Ø¹Ø·Ø§Ù„: Ø§Ø­ØªØ±Ø§Ù‚ØŒ Ø´Ø§Ø´Ø© Ù…Ø·ÙØ£Ø©ØŒ ÙÙ‚Ø¯ Ø¬Ù‡Ø¯ØŒ Ø¹Ø·Ù„ Ù…Ø±Ø§Ø¨Ø·.
15. Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚: Ù…Ø³Ø§Ù…ÙŠØ± ØªØ§Ù„ÙØ©ØŒ ØºØ·Ø§Ø¡ Ù…ÙƒØ³ÙˆØ±ØŒ Ø£Ø®ØªØ§Ù… Ù…Ù‚Ø·ÙˆØ¹Ø©.

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 8: Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ù„Ù…Ù†Ø·Ù‚
=========================================
16. Ù‚Ø±Ø§Ø¡Ø© "ÙƒÙ„Ø§Ù…Ø¨ Ù…ÙŠØªØ±" Ø¨ØªÙŠØ§Ø± Ø¹Ø§Ù„ÙŠ Ù…Ø¹ Ø´Ø§Ø´Ø© Ø¹Ø¯Ø§Ø¯ Ù…Ø·ÙØ£Ø© ØªØ¹Ù†ÙŠ ØªØ¬Ø§ÙˆØ²Ø§Ù‹ Ù…Ø¨Ø§Ø´Ø±Ø§Ù‹.

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 9: Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¹Ù‚Ù„ÙŠØ© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
=========================================
17. Ù„Ø§ ØªÙƒØªØ¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ø¶Ù…Ø§Ù† ØªØªØ¨Ø¹Ùƒ Ù„ÙƒØ§ÙØ© Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.

=========================================
Ø§Ù„Ù…Ø±Ø­Ù„Ø© 10: ØµÙŠØ§ØºØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
=========================================
18. Ø§Ù„ØªØ²Ù… Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ù†ØµÙŠØ§Ù‹ ÙˆØ¨Ø¯ÙˆÙ† Ù…Ù‚Ø¯Ù…Ø§Øª:

ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ Ø§Ù„ÙÙ†ÙŠ:
Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€

1ï¸âƒ£ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯:
â€¢ Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯: [Ø§Ù„Ù€ 16 Ø±Ù…Ø²]
â€¢ Ø§Ù„Ø³Ø§Ø¹Ø© ÙˆØ§Ù„Ø´Ø§Ø´Ø©: [ØµÙ Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ø§Ø´Ø©ØŒ Ù‚Ø±Ø§Ø¡Ø§Øª 1.8.0/2.8.0ØŒ Ø§Ù„Ø±Ù…ÙˆØ²ØŒ ÙˆÙ„Ù…Ø¨Ø§Øª Ø§Ù„Ù€ LED]

2ï¸âƒ£ Ø§Ù„Ù‚Ø§Ø·Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:
â€¢ Ø§Ù„Ø³Ø¹Ø© ÙˆØ­Ø§Ù„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„: [Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ù€ AØŒ ÙˆØ§Ù„ÙˆØ¶Ø¹ÙŠØ© ON/OFF]

3ï¸âƒ£ Ø§Ù„ØªÙˆØµÙŠÙ„Ø§Øª ÙˆÙ…Ø³Ø§Ø± Ø§Ù„ØªÙŠØ§Ø±:
â€¢ [ØªØªØ¨Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ Ø¨ÙˆØ¶ÙˆØ­. Ø­Ø¯Ø¯ ØµØ±Ø§Ø­Ø© Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ§Ø²Ø§Øª ØªØ¯Ø®Ù„ Ù„Ù„Ø³Ø§Ø¹Ø© Ø£Ù… ÙŠÙˆØ¬Ø¯ ØªØ¬Ø§ÙˆØ²/Bypass]

4ï¸âƒ£ Ø§Ù„Ø£Ø­Ù…Ø§Ù„:
â€¢ [ÙˆØµÙ Ù…ØµØ¯Ø± Ø§Ù„ØªØºØ°ÙŠØ© Ù„Ù„Ù…Ø´ØªØ±Ùƒ]

5ï¸âƒ£ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ÙˆÙ…Ø­ØªÙˆÙŠØ§ØªÙ‡ Ø§Ù„Ø¹Ø§Ù…Ø©:
â€¢ [Ø­Ø§Ù„Ø© Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ÙˆØ§Ù„Ù…Ø³Ø§Ù…ÙŠØ±]

6ï¸âƒ£ Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙÙ†ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©:
â€¢ [Ø£ÙŠ Ø´Ø°ÙˆØ°ØŒ Ø­Ø±Ù‚ØŒ Ø£Ùˆ Ù‚Ø±Ø§Ø¡Ø§Øª Ù„Ø£Ø¬Ù‡Ø²Ø© Ø®Ø§Ø±Ø¬ÙŠØ©]

ğŸ”´ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙˆØ§Ù„ØªÙØ³ÙŠØ±:
â€¢ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©: [Ø³Ù„ÙŠÙ… âœ… / ØºÙŠØ± Ø³Ù„ÙŠÙ… âš ï¸ (ØªØ¬Ø§ÙˆØ² ØºÙŠØ± Ù†Ø¸Ø§Ù…ÙŠ) / ØºÙŠØ± Ø³Ù„ÙŠÙ… ğŸ› ï¸ (Ø¹Ø·Ù„ ÙÙ†ÙŠ) / ØºÙŠØ± Ø³Ù„ÙŠÙ… ğŸš§ (Ø¹Ø§Ø¦Ù‚)]
â€¢ Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…Ø®ØªØµØ±: [Ø§Ø°ÙƒØ± Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ ÙˆÙ…ÙˆÙ‚Ø¹Ù‡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø§ Ø³Ø¨Ù‚]
`
    }]
};

// âš™ï¸ 2. Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ API
export const useImageAnalysis = () => {
    const [loading, setLoading] = useState(false);
    const [result, setResult] = useState<string | null>(null);
    const [chatLoading, setChatLoading] = useState(false);
    const [chatHistory, setChatHistory] = useState<{ role: string; text: string }[]>([]);
    const [savedImageParts, setSavedImageParts] = useState<any[] | null>(null);

    const resetAnalysis = () => {
        setResult(null);
        setChatHistory([]);
        setSavedImageParts(null);
        if (window.speechSynthesis) window.speechSynthesis.cancel();
    };

    const analyzeImage = async (imageInput: File | File[]) => {
        setLoading(true);
        setResult(null);
        setChatHistory([]);
        const apiKey = process.env.NEXT_PUBLIC_GEMINI_API_KEY;
        const files = Array.isArray(imageInput) ? imageInput : [imageInput];

        try {
            const imageParts = await Promise.all(
                files.map((file) => new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onloadend = () => {
                        const base64Data = (reader.result as string).split(',')[1];
                        resolve({ inline_data: { mime_type: file.type, data: base64Data } });
                    };
                    reader.onerror = () => reject(new Error("ÙØ´Ù„ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù"));
                }))
            );

            setSavedImageParts(imageParts);

            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=${apiKey}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    system_instruction: SYSTEM_INSTRUCTION,
                    contents: [
                        {
                            parts: [
                                { text: "Ù‚Ù… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„ÙÙ†ÙŠ Ù„Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙ‚Ø© ÙˆØ¥ØµØ¯Ø§Ø± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ØŒ ÙˆØªØªØ¨Ø¹ Ø§Ù„Ø£Ø³Ù„Ø§Ùƒ Ø¨Ø¯Ù‚Ø©." },
                                ...imageParts as any[]
                            ]
                        }
                    ],
                    safetySettings: [
                        { category: "HARM_CATEGORY_HARASSMENT", threshold: "BLOCK_NONE" },
                        { category: "HARM_CATEGORY_HATE_SPEECH", threshold: "BLOCK_NONE" },
                        { category: "HARM_CATEGORY_SEXUALLY_EXPLICIT", threshold: "BLOCK_NONE" },
                        { category: "HARM_CATEGORY_DANGEROUS_CONTENT", threshold: "BLOCK_NONE" }
                    ],
                    generationConfig: {
                        temperature: 0.1, // Ù„Ø¶Ù…Ø§Ù† Ø¯Ù‚Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØ¹Ø¯Ù… Ø§Ù„Ù‡Ù„ÙˆØ³Ø©
                        maxOutputTokens: 8192 // ğŸš€ ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø³Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù…Ù†Ø¹ Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± (MAX_TOKENS)
                    }
                })
            });

            const data = await response.json();

            if (data.error) {
                console.error("API Error:", data.error);
                setResult(`âŒ Ø®Ø·Ø£ ØªÙ‚Ù†ÙŠ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±: ${data.error.message}`);
                return;
            }

            const finishReason = data.candidates?.[0]?.finishReason;
            const outputText = data.candidates?.[0]?.content?.parts?.[0]?.text;

            if (outputText) {
                const inspectionTime = new Date().toLocaleString('ar-SA');
                setResult(`ğŸ•’ ÙˆÙ‚Øª Ø§Ù„ÙØ­Øµ: ${inspectionTime}\nÙ€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€\n\n${outputText}`);
            } else if (finishReason === 'SAFETY') {
                setResult("âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„ØªØ­Ù„ÙŠÙ„: ØªÙ… Ø­Ø¬Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨ÙˆØ§Ø³Ø·Ø© ÙÙ„Ø§ØªØ± Ø§Ù„Ø£Ù…Ø§Ù†.");
            } else {
                setResult(`âš ï¸ ØªØ¹Ø°Ø± ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©. Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ (Finish Reason): ${finishReason || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`);
            }
        } catch (error) {
            setResult("âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ£ÙƒØ¯ Ù…Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØµÙ„Ø§Ø­ÙŠØ© Ù…ÙØªØ§Ø­ Ø§Ù„Ù€ API.");
        } finally {
            setLoading(false);
        }
    };

    const askFollowUp = async (question: string) => {
        if (!savedImageParts || !result || !question.trim()) return;
        setChatLoading(true);
        const apiKey = process.env.NEXT_PUBLIC_GEMINI_API_KEY;
        setChatHistory((prev) => [...prev, { role: "user", text: question }]);

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=${apiKey}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    system_instruction: { parts: [{ text: "Ø£Ù†Øª Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„ÙÙ†ÙŠ. Ø£Ø¬Ø¨ Ø¨Ø§Ø®ØªØµØ§Ø± Ù‡Ù†Ø¯Ø³ÙŠ Ø­Ø§Ø¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙˆØ§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙ‚Ø©." }] },
                    contents: [
                        { parts: [{ text: `Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ø§Ø¨Ù‚: "${result}"\nØ³Ø¤Ø§Ù„ Ø§Ù„ÙÙ†ÙŠ: "${question}"` }, ...savedImageParts] }
                    ],
                    generationConfig: {
                        temperature: 0.1,
                        maxOutputTokens: 2048
                    }
                })
            });

            const data = await response.json();
            const aiReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø© ÙÙ†ÙŠØ© ÙˆØ§Ø¶Ø­Ø©.";
            setChatHistory((prev) => [...prev, { role: "ai", text: aiReply }]);
        } catch (error) {
            setChatHistory((prev) => [...prev, { role: "ai", text: "âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±." }]);
        } finally {
            setChatLoading(false);
        }
    };

    return { analyzeImage, loading, result, resetAnalysis, askFollowUp, chatHistory, chatLoading };
};